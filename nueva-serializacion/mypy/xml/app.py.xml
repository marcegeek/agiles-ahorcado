<?xml-stylesheet type="text/xsl" href="../mypy-html.xslt"?><mypy-report-file name="app.py" module="app"><line any_info="No Anys on this line!" content="&quot;&quot;&quot;Aplicación web Flask del juego del ahorcado.&quot;&quot;&quot;" number="1" precision="empty"/><line any_info="No Anys on this line!" content="" number="2" precision="empty"/><line any_info="No Anys on this line!" content="from __future__ import annotations" number="3" precision="precise"/><line any_info="No Anys on this line!" content="" number="4" precision="empty"/><line any_info="No Anys on this line!" content="import os" number="5" precision="precise"/><line any_info="No Anys on this line!" content="from typing import TYPE_CHECKING" number="6" precision="precise"/><line any_info="No Anys on this line!" content="" number="7" precision="empty"/><line any_info="No Anys on this line!" content="from flask import Flask, flash, redirect, render_template, request, session, url_for" number="8" precision="precise"/><line any_info="No Anys on this line!" content="" number="9" precision="empty"/><line any_info="No Anys on this line!" content="from ahorcado import Juego, Partida" number="10" precision="precise"/><line any_info="No Anys on this line!" content="" number="11" precision="empty"/><line any_info="No Anys on this line!" content="if TYPE_CHECKING:" number="12" precision="precise"/><line any_info="No Anys on this line!" content="    from flask.typing import ResponseValue" number="13" precision="precise"/><line any_info="No Anys on this line!" content="" number="14" precision="empty"/><line any_info="No Anys on this line!" content="app = Flask(__name__)" number="15" precision="precise"/><line any_info="Any Types on this line: &#10;Explicit (x1)&#10;Omitted Generics (x2)" content="app.secret_key = os.environ.get(&quot;SECRET_KEY&quot;, &quot;default_secret_key&quot;)" number="16" precision="imprecise"/><line any_info="No Anys on this line!" content="" number="17" precision="empty"/><line any_info="No Anys on this line!" content="" number="18" precision="empty"/><line any_info="Any Types on this line: &#10;Omitted Generics (x4)&#10;Explicit (x1)" content="@app.route(&quot;/&quot;)" number="19" precision="precise"/><line any_info="No Anys on this line!" content="def index() -&gt; ResponseValue:" number="20" precision="precise"/><line any_info="No Anys on this line!" content="    &quot;&quot;&quot;Devuelve la página principal.&quot;&quot;&quot;" number="21" precision="empty"/><line any_info="Any Types on this line: &#10;Explicit (x1)" content="    return render_template(&quot;index.html&quot;)" number="22" precision="precise"/><line any_info="No Anys on this line!" content="" number="23" precision="empty"/><line any_info="No Anys on this line!" content="" number="24" precision="empty"/><line any_info="No Anys on this line!" content="def iniciar_juego() -&gt; None:" number="25" precision="precise"/><line any_info="No Anys on this line!" content="    &quot;&quot;&quot;Inicia un juego simple con la palabra ingresada.&quot;&quot;&quot;" number="26" precision="empty"/><line any_info="No Anys on this line!" content="    palabra = request.form[&quot;palabra&quot;]" number="27" precision="precise"/><line any_info="No Anys on this line!" content="    try:" number="28" precision="empty"/><line any_info="No Anys on this line!" content="        juego = Juego(palabra=palabra)" number="29" precision="precise"/><line any_info="Any Types on this line: &#10;Explicit (x2)" content="        session[&quot;juego&quot;] = juego.to_dict()" number="30" precision="imprecise"/><line any_info="No Anys on this line!" content="    except ValueError as e:" number="31" precision="precise"/><line any_info="No Anys on this line!" content="        flash(str(e), category=&quot;error&quot;)" number="32" precision="precise"/><line any_info="No Anys on this line!" content="" number="33" precision="empty"/><line any_info="No Anys on this line!" content="" number="34" precision="empty"/><line any_info="No Anys on this line!" content="def arriesgar(juego: Juego) -&gt; str:" number="35" precision="precise"/><line any_info="No Anys on this line!" content="    &quot;&quot;&quot;Arriesgar letra o palabra en el juego actual.&quot;&quot;&quot;" number="36" precision="empty"/><line any_info="No Anys on this line!" content="    intento = request.form[&quot;intento&quot;]" number="37" precision="precise"/><line any_info="No Anys on this line!" content="    metodo = juego.arriesgar_letra if len(intento) == 1 else juego.arriesgar_palabra" number="38" precision="precise"/><line any_info="No Anys on this line!" content="    return metodo(intento)" number="39" precision="precise"/><line any_info="No Anys on this line!" content="" number="40" precision="empty"/><line any_info="No Anys on this line!" content="" number="41" precision="empty"/><line any_info="Any Types on this line: &#10;Omitted Generics (x4)&#10;Explicit (x1)" content="@app.route(&quot;/juego&quot;, methods=[&quot;GET&quot;, &quot;POST&quot;])" number="42" precision="any"/><line any_info="No Anys on this line!" content="def juego() -&gt; ResponseValue:" number="43" precision="precise"/><line any_info="No Anys on this line!" content="    &quot;&quot;&quot;Permite arriesgar en el juego actual o iniciar uno nuevo y devuelve la vista.&quot;&quot;&quot;" number="44" precision="empty"/><line any_info="No Anys on this line!" content="    if &quot;juego&quot; not in session:" number="45" precision="precise"/><line any_info="No Anys on this line!" content="        if request.method == &quot;POST&quot;:" number="46" precision="precise"/><line any_info="No Anys on this line!" content="            iniciar_juego()" number="47" precision="precise"/><line any_info="Any Types on this line: &#10;Explicit (x1)" content="            return redirect(url_for(&quot;juego&quot;))" number="48" precision="precise"/><line any_info="Any Types on this line: &#10;Explicit (x1)" content="        return render_template(&quot;juego-inicio.html&quot;)" number="49" precision="precise"/><line any_info="Any Types on this line: &#10;Explicit (x1)&#10;Error (x1)" content="    juego = Juego.from_dict(session[&quot;juego&quot;])" number="50" precision="any"/><line any_info="No Anys on this line!" content="    resultado = None" number="51" precision="precise"/><line any_info="No Anys on this line!" content="    if request.method == &quot;POST&quot;:" number="52" precision="precise"/><line any_info="No Anys on this line!" content="        resultado = arriesgar(juego)" number="53" precision="precise"/><line any_info="Any Types on this line: &#10;Explicit (x2)" content="        session[&quot;juego&quot;] = juego.to_dict()" number="54" precision="imprecise"/><line any_info="Any Types on this line: &#10;Explicit (x1)" content="    return render_template(&quot;juego.html&quot;, juego=juego, resultado=resultado)" number="55" precision="any"/><line any_info="No Anys on this line!" content="" number="56" precision="empty"/><line any_info="No Anys on this line!" content="" number="57" precision="empty"/><line any_info="No Anys on this line!" content="def url_redireccion(fallback: str | None = None) -&gt; str:" number="58" precision="precise"/><line any_info="No Anys on this line!" content="    &quot;&quot;&quot;Obtiene la URL a la que redirigir.&quot;&quot;&quot;" number="59" precision="empty"/><line any_info="No Anys on this line!" content="    if fallback is None:" number="60" precision="precise"/><line any_info="Any Types on this line: &#10;Explicit (x1)" content="        fallback = url_for(&quot;index&quot;)" number="61" precision="precise"/><line any_info="Any Types on this line: &#10;Omitted Generics (x5)" content="    redirecciones = request.values.get(&quot;redirect_to&quot;), request.referrer, fallback" number="62" precision="precise"/><line any_info="Any Types on this line: &#10;Omitted Generics (x6)" content="    return next(r for r in redirecciones if r)" number="63" precision="precise"/><line any_info="No Anys on this line!" content="" number="64" precision="empty"/><line any_info="No Anys on this line!" content="" number="65" precision="empty"/><line any_info="Any Types on this line: &#10;Omitted Generics (x4)&#10;Explicit (x1)" content="@app.route(&quot;/finalizar&quot;, methods=[&quot;POST&quot;])" number="66" precision="any"/><line any_info="No Anys on this line!" content="def finalizar() -&gt; ResponseValue:" number="67" precision="precise"/><line any_info="No Anys on this line!" content="    &quot;&quot;&quot;Finaliza el juego y/o partida actual.&quot;&quot;&quot;" number="68" precision="empty"/><line any_info="Any Types on this line: &#10;Error (x8)&#10;Omitted Generics (x2)" content="    session.pop(&quot;juego&quot;, None)" number="69" precision="any"/><line any_info="Any Types on this line: &#10;Error (x8)&#10;Omitted Generics (x2)" content="    session.pop(&quot;jugadores&quot;, None)" number="70" precision="any"/><line any_info="Any Types on this line: &#10;Error (x8)&#10;Omitted Generics (x2)" content="    session.pop(&quot;partida&quot;, None)" number="71" precision="any"/><line any_info="No Anys on this line!" content="    return redirect(url_redireccion())" number="72" precision="precise"/><line any_info="No Anys on this line!" content="" number="73" precision="empty"/><line any_info="No Anys on this line!" content="" number="74" precision="empty"/><line any_info="No Anys on this line!" content="def iniciar_partida() -&gt; None:" number="75" precision="precise"/><line any_info="No Anys on this line!" content="    &quot;&quot;&quot;Inicia una nueva partida con los jugadores ingresados.&quot;&quot;&quot;" number="76" precision="empty"/><line any_info="No Anys on this line!" content="    keys = [&quot;jugador1&quot;, &quot;jugador2&quot;]" number="77" precision="precise"/><line any_info="No Anys on this line!" content="    session[&quot;jugadores&quot;] = [request.form[k] for k in keys]" number="78" precision="precise"/><line any_info="No Anys on this line!" content="    p = Partida()" number="79" precision="precise"/><line any_info="Any Types on this line: &#10;Explicit (x2)" content="    session[&quot;partida&quot;] = p.to_dict()" number="80" precision="imprecise"/><line any_info="No Anys on this line!" content="" number="81" precision="empty"/><line any_info="No Anys on this line!" content="" number="82" precision="empty"/><line any_info="No Anys on this line!" content="def iniciar_ronda(partida: Partida) -&gt; None:" number="83" precision="precise"/><line any_info="No Anys on this line!" content="    &quot;&quot;&quot;Inicia una nueva ronda en la partida actual con la palabra ingresada.&quot;&quot;&quot;" number="84" precision="empty"/><line any_info="No Anys on this line!" content="    palabra = request.form[&quot;palabra&quot;]" number="85" precision="precise"/><line any_info="No Anys on this line!" content="    partida.comenzar_ronda(palabra)" number="86" precision="precise"/><line any_info="Any Types on this line: &#10;Explicit (x2)" content="    session[&quot;partida&quot;] = partida.to_dict()" number="87" precision="imprecise"/><line any_info="No Anys on this line!" content="" number="88" precision="empty"/><line any_info="No Anys on this line!" content="" number="89" precision="empty"/><line any_info="Any Types on this line: &#10;Omitted Generics (x4)&#10;Explicit (x1)" content="@app.route(&quot;/partida&quot;, methods=[&quot;GET&quot;, &quot;POST&quot;])" number="90" precision="any"/><line any_info="No Anys on this line!" content="def partida() -&gt; ResponseValue:" number="91" precision="precise"/><line any_info="No Anys on this line!" content="    &quot;&quot;&quot;Permite arriesgar en la partida actual, iniciar una nueva o iniciar una ronda y devuelve la vista.&quot;&quot;&quot;" number="92" precision="empty"/><line any_info="Any Types on this line: &#10;Error (x7)&#10;Omitted Generics (x2)" content="    jugadores = session.get(&quot;jugadores&quot;)" number="93" precision="imprecise"/><line any_info="Any Types on this line: &#10;Explicit (x1)&#10;Error (x1)" content="    partida = Partida.from_dict(session[&quot;partida&quot;]) if &quot;partida&quot; in session else None" number="94" precision="any"/><line any_info="No Anys on this line!" content="    if not partida:" number="95" precision="precise"/><line any_info="No Anys on this line!" content="        if request.method == &quot;POST&quot;:" number="96" precision="precise"/><line any_info="No Anys on this line!" content="            iniciar_partida()" number="97" precision="precise"/><line any_info="Any Types on this line: &#10;Explicit (x1)" content="            return redirect(url_for(&quot;partida&quot;))" number="98" precision="precise"/><line any_info="Any Types on this line: &#10;Explicit (x1)" content="        return render_template(" number="99" precision="any"/><line any_info="No Anys on this line!" content="            &quot;partida-inicio.html&quot;," number="100" precision="precise"/><line any_info="Any Types on this line: &#10;Error (x1)" content="            jugadores=jugadores," number="101" precision="imprecise"/><line any_info="No Anys on this line!" content="            partida=partida," number="102" precision="precise"/><line any_info="No Anys on this line!" content="        )" number="103" precision="empty"/><line any_info="No Anys on this line!" content="" number="104" precision="empty"/><line any_info="No Anys on this line!" content="    hay_que_iniciar_ronda = partida.id_jugador_actual is None or partida.ronda_finalizo()" number="105" precision="precise"/><line any_info="No Anys on this line!" content="    jugador_palabra = 0 if partida.id_jugador_actual is None else partida.id_jugador_actual" number="106" precision="precise"/><line any_info="No Anys on this line!" content="    jugador_adivina = (jugador_palabra + 1) % 2" number="107" precision="precise"/><line any_info="No Anys on this line!" content="    if request.method == &quot;POST&quot;:" number="108" precision="precise"/><line any_info="No Anys on this line!" content="        if not partida.finalizo():" number="109" precision="precise"/><line any_info="No Anys on this line!" content="            if hay_que_iniciar_ronda:" number="110" precision="precise"/><line any_info="No Anys on this line!" content="                iniciar_ronda(partida)" number="111" precision="precise"/><line any_info="No Anys on this line!" content="            else:" number="112" precision="empty"/><line any_info="No Anys on this line!" content="                arriesgar(partida.juego)  # type: ignore[arg-type]" number="113" precision="precise"/><line any_info="No Anys on this line!" content="                partida.actualizar_puntos()" number="114" precision="precise"/><line any_info="Any Types on this line: &#10;Explicit (x2)" content="                session[&quot;partida&quot;] = partida.to_dict()" number="115" precision="imprecise"/><line any_info="No Anys on this line!" content="        else:" number="116" precision="empty"/><line any_info="No Anys on this line!" content="            flash(&quot;La partida ya finalizó&quot;, category=&quot;error&quot;)" number="117" precision="precise"/><line any_info="Any Types on this line: &#10;Explicit (x1)" content="        return redirect(url_for(&quot;partida&quot;))" number="118" precision="precise"/><line any_info="Any Types on this line: &#10;Explicit (x1)" content="    return render_template(" number="119" precision="any"/><line any_info="No Anys on this line!" content="        &quot;partida.html&quot;," number="120" precision="precise"/><line any_info="Any Types on this line: &#10;Error (x1)" content="        jugadores=jugadores," number="121" precision="imprecise"/><line any_info="No Anys on this line!" content="        partida=partida," number="122" precision="precise"/><line any_info="No Anys on this line!" content="        iniciar_ronda=hay_que_iniciar_ronda," number="123" precision="precise"/><line any_info="No Anys on this line!" content="        jugador_palabra=jugador_palabra," number="124" precision="precise"/><line any_info="No Anys on this line!" content="        jugador_adivina=jugador_adivina," number="125" precision="precise"/><line any_info="No Anys on this line!" content="    )" number="126" precision="empty"/><line any_info="No Anys on this line!" content="" number="127" precision="empty"/><line any_info="No Anys on this line!" content="" number="128" precision="empty"/><line any_info="No Anys on this line!" content="if __name__ == &quot;__main__&quot;:" number="129" precision="precise"/><line any_info="No Anys on this line!" content="    # ruff: noqa: S201: ignorar uso de debug=True" number="130" precision="empty"/><line any_info="Any Types on this line: &#10;Explicit (x1)" content="    app.run(debug=True)" number="131" precision="precise"/></mypy-report-file>